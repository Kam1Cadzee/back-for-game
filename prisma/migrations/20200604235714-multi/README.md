# Migration `20200604235714-multi`

This migration has been generated by Vadim Vereketa at 6/4/2020, 11:57:14 PM.
You can check out the [state of the schema](./schema.prisma) after the migration.

## Database Steps

```sql
CREATE TABLE "public"."_disconnectEntities" (
"A" integer  NOT NULL ,"B" integer  NOT NULL )

CREATE TABLE "public"."_disconnectPhrases" (
"A" integer  NOT NULL ,"B" integer  NOT NULL )

CREATE TABLE "public"."_disconnectSentences" (
"A" integer  NOT NULL ,"B" integer  NOT NULL )

CREATE TABLE "public"."_disconnectTranslate" (
"A" integer  NOT NULL ,"B" integer  NOT NULL )

ALTER TABLE "public"."MobileApp" ALTER COLUMN "status" SET DEFAULT 'WORK';

ALTER TABLE "public"."Translate" ALTER COLUMN "type" SET DEFAULT 'OTHER';

ALTER TABLE "public"."User" ALTER COLUMN "role" SET DEFAULT 'STANDARD';

ALTER TABLE "public"."Word" ALTER COLUMN "type" SET DEFAULT 'OTHER';

CREATE UNIQUE INDEX "_disconnectEntities_AB_unique" ON "public"."_disconnectEntities"("A","B")

CREATE  INDEX "_disconnectEntities_B_index" ON "public"."_disconnectEntities"("B")

CREATE UNIQUE INDEX "_disconnectPhrases_AB_unique" ON "public"."_disconnectPhrases"("A","B")

CREATE  INDEX "_disconnectPhrases_B_index" ON "public"."_disconnectPhrases"("B")

CREATE UNIQUE INDEX "_disconnectSentences_AB_unique" ON "public"."_disconnectSentences"("A","B")

CREATE  INDEX "_disconnectSentences_B_index" ON "public"."_disconnectSentences"("B")

CREATE UNIQUE INDEX "_disconnectTranslate_AB_unique" ON "public"."_disconnectTranslate"("A","B")

CREATE  INDEX "_disconnectTranslate_B_index" ON "public"."_disconnectTranslate"("B")

ALTER TABLE "public"."_disconnectEntities" ADD FOREIGN KEY ("A")REFERENCES "public"."Entity"("id") ON DELETE CASCADE  ON UPDATE CASCADE

ALTER TABLE "public"."_disconnectEntities" ADD FOREIGN KEY ("B")REFERENCES "public"."Word"("id") ON DELETE CASCADE  ON UPDATE CASCADE

ALTER TABLE "public"."_disconnectPhrases" ADD FOREIGN KEY ("A")REFERENCES "public"."Entity"("id") ON DELETE CASCADE  ON UPDATE CASCADE

ALTER TABLE "public"."_disconnectPhrases" ADD FOREIGN KEY ("B")REFERENCES "public"."Phrase"("id") ON DELETE CASCADE  ON UPDATE CASCADE

ALTER TABLE "public"."_disconnectSentences" ADD FOREIGN KEY ("A")REFERENCES "public"."Entity"("id") ON DELETE CASCADE  ON UPDATE CASCADE

ALTER TABLE "public"."_disconnectSentences" ADD FOREIGN KEY ("B")REFERENCES "public"."Sentence"("id") ON DELETE CASCADE  ON UPDATE CASCADE

ALTER TABLE "public"."_disconnectTranslate" ADD FOREIGN KEY ("A")REFERENCES "public"."Translate"("id") ON DELETE CASCADE  ON UPDATE CASCADE

ALTER TABLE "public"."_disconnectTranslate" ADD FOREIGN KEY ("B")REFERENCES "public"."Word"("id") ON DELETE CASCADE  ON UPDATE CASCADE
```

## Changes

```diff
diff --git schema.prisma schema.prisma
migration 20200604010102-enti..20200604235714-multi
--- datamodel.dml
+++ datamodel.dml
@@ -8,9 +8,9 @@
 }
 datasource db {
   provider = "postgresql"
-  url = "***"
+  url      = env("DATABASE_URL")
 }
 model User {
   createdAt DateTime @default(now())
@@ -72,44 +72,54 @@
   isNeededEdit Boolean    @default(false)
   createdAt    DateTime   @default(now())
   updatedAt    DateTime   @default(now())
   @@unique([title, userId], name: "unique_title_userId")
+
+  disconnectWords     Word[]     @relation("disconnectEntities")
+  disconnectPhrases   Phrase[]   @relation("disconnectPhrases")
+  disconnectSentences Sentence[] @relation("disconnectSentences")
 }
 model Word {
   id        Int          @default(autoincrement()) @id
   en        String
-  translate Translate[]  @relation(references: [id])
+  translate Translate[]
   type      PartOfSpeech @default(OTHER)
   entities  Entity[]
   createdAt DateTime     @default(now())
   updatedAt DateTime     @default(now())
   User      User         @relation(fields: [userId], references: [id])
   userId    Int
+
+  disconnectEntities  Entity[]    @relation("disconnectEntities")
+  disconnectTranslate Translate[] @relation("disconnectTranslate")
   @@unique([en, userId], name: "AnotherUser_firstname_lastname_key")
 }
 model Translate {
-  id        Int          @default(autoincrement()) @id
-  ru        String       @unique
-  type      PartOfSpeech @default(OTHER)
-  words     Word[]       @relation(references: [id])
-  createdAt DateTime     @default(now())
-  updatedAt DateTime     @default(now())
+  id              Int          @default(autoincrement()) @id
+  ru              String       @unique
+  type            PartOfSpeech @default(OTHER)
+  words           Word[]
+  createdAt       DateTime     @default(now())
+  updatedAt       DateTime     @default(now())
+  disconnectWords Word[]       @relation("disconnectTranslate")
 }
 model Phrase {
-  id       Int      @default(autoincrement()) @id
-  phrase   String   @unique
-  ru       String
-  entities Entity[]
+  id                 Int      @default(autoincrement()) @id
+  phrase             String   @unique
+  ru                 String
+  entities           Entity[]
+  disconnectEntities Entity[] @relation("disconnectPhrases")
 }
 model Sentence {
-  id       Int      @default(autoincrement()) @id
-  sentence String   @unique
-  ru       String
-  entities Entity[]
+  id                 Int      @default(autoincrement()) @id
+  sentence           String   @unique
+  ru                 String
+  entities           Entity[]
+  disconnectEntities Entity[] @relation("disconnectSentences")
 }
 model MobileApp {
   id        Int          @default(autoincrement()) @id
```


