# Migration `20200531234003-multi-entities`

This migration has been generated by Vadim Vereketa at 5/31/2020, 11:40:03 PM.
You can check out the [state of the schema](./schema.prisma) after the migration.

## Database Steps

```sql
CREATE TABLE "public"."_EntityToWord" (
"A" integer  NOT NULL ,"B" integer  NOT NULL )

ALTER TABLE "public"."Translate" ALTER COLUMN "type" SET DEFAULT 'OTHER';

ALTER TABLE "public"."User" ALTER COLUMN "role" SET DEFAULT 'STANDARD';

ALTER TABLE "public"."Word" DROP CONSTRAINT IF EXiSTS "Word_entityId_fkey",
DROP COLUMN "entityId",
ALTER COLUMN "type" SET DEFAULT 'OTHER';

CREATE UNIQUE INDEX "_EntityToWord_AB_unique" ON "public"."_EntityToWord"("A","B")

CREATE  INDEX "_EntityToWord_B_index" ON "public"."_EntityToWord"("B")

ALTER TABLE "public"."_EntityToWord" ADD FOREIGN KEY ("A")REFERENCES "public"."Entity"("id") ON DELETE CASCADE  ON UPDATE CASCADE

ALTER TABLE "public"."_EntityToWord" ADD FOREIGN KEY ("B")REFERENCES "public"."Word"("id") ON DELETE CASCADE  ON UPDATE CASCADE
```

## Changes

```diff
diff --git schema.prisma schema.prisma
migration 20200531181019-time..20200531234003-multi-entities
--- datamodel.dml
+++ datamodel.dml
@@ -8,9 +8,9 @@
 }
 datasource db {
   provider = "postgresql"
-  url = "***"
+  url      = env("DATABASE_URL")
 }
 model User {
   createdAt DateTime @default(now())
@@ -77,10 +77,9 @@
   id        Int          @default(autoincrement()) @id
   en        String       @unique
   translate Translate[]  @relation(references: [id])
   type      PartOfSpeech @default(OTHER)
-  entity    Entity       @relation(fields: [entityId], references: [id])
-  entityId  Int
+  entities  Entity[]
   createdAt DateTime     @default(now())
   updatedAt DateTime     @default(now())
 }
```


